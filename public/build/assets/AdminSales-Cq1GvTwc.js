import{_ as B,c as v,a as s,w as n,r as i,m as L,o as p,i as k,d as V,b as l,f as h,t as u,e as S,l as X,F as z,h as Y,p as K}from"./app-CiFPWy5I.js";import{a as J}from"./adminPaginationMixin-BpksgI63.js";const Z={props:["fieldLabel","required","variant","min","initialDate"],data(){return{isMenuOpen:null,selectedDate:this.initialDate==null?null:new Date(this.initialDate),dbFormatDate:null,dateFieldLavel:this.fieldLabel??"Selected date",fieldPlaceHolder:"Enter "+this.fieldLabel,yesterdayIso:new Date(new Date().setDate(new Date().getDate()-1))}},computed:{computedCustomValue(){if(this.selectedDate)return this.frmtInsideDate(this.selectedDate)}},watch:{computedCustomValue:function(a){a&&this.dbFormatDate!==null&&this.$emit("trigerInputValue",this.dbFormatDate)},initialDate:function(a){a?(this.selectedDate=new Date(a),this.$nextTick(()=>{this.computedCustomValue&&this.dbFormatDate&&this.$emit("trigerInputValue",this.dbFormatDate)})):(this.selectedDate=null,this.dbFormatDate=null,this.$emit("trigerInputValue",null))}},mounted(){this.initialDate&&this.selectedDate&&this.$nextTick(()=>{this.computedCustomValue&&this.dbFormatDate&&this.$emit("trigerInputValue",this.dbFormatDate)})},methods:{onClear(){this.selectedDate=null,this.dbFormatDate=null,this.$emit("trigerInputValue",null)},frmtInsideDate(a){const e=new Date(a),r=e.getDate(),_=e.getMonth()+1,t=e.getFullYear(),o=r.toString().padStart(2,"0"),m=_.toString().padStart(2,"0"),g=`${o}/${m}/${t}`;return this.dbFormatDate=`${t}-${m}-${o}`,g}}};function $(a,e,r,_,t,o){const m=i("v-text-field"),g=i("v-date-picker"),y=i("v-menu");return p(),v("div",null,[s(y,{modelValue:t.isMenuOpen,"onUpdate:modelValue":e[3]||(e[3]=f=>t.isMenuOpen=f),"close-on-content-click":!1},{activator:n(({props:f})=>[s(m,L({label:t.dateFieldLavel,placeholder:t.fieldPlaceHolder,"model-value":o.computedCustomValue,readonly:""},f,{clearable:"","onClick:clear":e[0]||(e[0]=w=>o.onClear()),density:"compact",class:r.required?"required":null,variant:r.variant?r.variant:"outlined",rules:[r.required?w=>!!w||`This ${t.dateFieldLavel} is required`:null]}),null,16,["label","placeholder","model-value","class","variant","rules"])]),default:n(()=>[s(g,{"show-adjacent-months":"","hide-header":"","hide-actions":"",position:"sticky",modelValue:t.selectedDate,"onUpdate:modelValue":[e[1]||(e[1]=f=>t.selectedDate=f),e[2]||(e[2]=f=>(t.isMenuOpen=!1,r.initialDate=null))],min:r.min?t.yesterdayIso:null},null,8,["modelValue","min"])]),_:1},8,["modelValue"])])}const ee=B(Z,[["render",$]]),te={name:"SaleDialog",mixins:[J],components:{DatePickerVuetifyInput:ee},props:{modelValue:{type:Boolean,required:!0},sale:{type:Object,default:null}},emits:["update:modelValue","saved"],data(){return{form:this.getEmptyForm(),formValid:!1,cartItems:[],productSearch:"",searchResults:[],customers:[],warehouses:[],saving:!1,paymentMethod:"cash",paymentMethods:[{title:"Cash",value:"cash"},{title:"Card",value:"card"},{title:"Mobile Banking",value:"mobile_banking"},{title:"Bank Transfer",value:"bank_transfer"},{title:"Cheque",value:"cheque"}],rules:{required:a=>!!a||"Required"}}},computed:{isEdit(){return!!this.form.id}},watch:{sale:{immediate:!0,async handler(a){a&&a.id?await this.loadSaleForEdit(a.id):(this.form=this.getEmptyForm(),this.cartItems=[])}},modelValue(a){a?(this.fetchOptions(),(!this.sale||!this.sale.id)&&(this.form=this.getEmptyForm(),this.cartItems=[])):(this.form=this.getEmptyForm(),this.cartItems=[])}},methods:{getEmptyForm(){return{id:null,customer_id:null,warehouse_id:null,invoice_date:new Date().toISOString().split("T")[0],due_date:null,subtotal:0,tax_amount:0,discount_amount:0,shipping_cost:0,total_amount:0,paid_amount:0,balance_amount:0,notes:""}},async fetchOptions(){try{const[a,e]=await Promise.all([k.get("/api/v1/customers"),k.get("/api/v1/warehouses")]);this.customers=a.data.data||a.data.customers||[],this.warehouses=e.data.data||e.data.warehouses||[]}catch(a){console.error("Failed to load options",a)}},async searchProducts(){if(this.productSearch)try{const{data:a}=await k.get("/api/v1/products",{params:{search:this.productSearch,per_page:10}});this.searchResults=a.data||a.products||[]}catch(a){console.error("Failed to search products",a)}},addToCart(a){const e=this.cartItems.findIndex(r=>r.product_id===a.id);if(e>=0)this.cartItems[e].quantity++,this.updateCartItem(e);else{const r=a.sale_price*(a.tax_rate||0)/100;this.cartItems.push({product_id:a.id,product_name:a.name,quantity:1,unit_price:parseFloat(a.sale_price),discount:0,tax:parseFloat(r.toFixed(2)),total:parseFloat(a.sale_price)+r})}this.productSearch="",this.searchResults=[],this.calculateTotals()},updateCartItem(a){const e=this.cartItems[a],r=e.quantity*e.unit_price;e.total=r-e.discount+e.tax,this.calculateTotals()},removeFromCart(a){this.cartItems.splice(a,1),this.calculateTotals()},calculateTotals(){const a=this.cartItems.reduce((t,o)=>t+o.quantity*o.unit_price,0),e=this.cartItems.reduce((t,o)=>t+o.discount,0),r=this.cartItems.reduce((t,o)=>t+o.tax,0);this.form.subtotal=parseFloat(a.toFixed(2));const _=a-e-(this.form.discount_amount||0)+r+(this.form.tax_amount||0)+(this.form.shipping_cost||0);this.form.total_amount=parseFloat(_.toFixed(2)),this.calculateBalance()},calculateBalance(){this.form.balance_amount=parseFloat((this.form.total_amount-(this.form.paid_amount||0)).toFixed(2))},async loadSaleForEdit(a){var e,r,_;if(a)try{const o=(await k.get(`/api/v1/sales/${a}`)).data;if(!o){this.showError("Sale not found");return}console.log("Loading sale for edit:",o),this.form={id:o.id,customer_id:o.customer_id,warehouse_id:o.warehouse_id,invoice_date:o.invoice_date?o.invoice_date.includes("T")?o.invoice_date.split("T")[0]:o.invoice_date:new Date().toISOString().split("T")[0],due_date:o.due_date?o.due_date.includes("T")?o.due_date.split("T")[0]:o.due_date:null,subtotal:parseFloat(o.subtotal||0),tax_amount:parseFloat(o.tax_amount||0),discount_amount:parseFloat(o.discount_amount||0),shipping_cost:parseFloat(o.shipping_cost||0),total_amount:parseFloat(o.total_amount||0),paid_amount:parseFloat(o.paid_amount||0),balance_amount:parseFloat(o.balance_amount||0),notes:o.notes||""},o.items&&Array.isArray(o.items)&&o.items.length>0?this.cartItems=o.items.map(m=>{var D;const g=(m.quantity||0)*(m.unit_price||0),y=parseFloat(m.discount||0),f=parseFloat(m.tax||0),w=g-y+f;return{product_id:m.product_id,product_name:((D=m.product)==null?void 0:D.name)||"Unknown",quantity:parseInt(m.quantity,10),unit_price:parseFloat(m.unit_price||0),discount:y,tax:f,total:w}}):this.cartItems=[],this.calculateTotals()}catch(t){console.error("Failed to load sale for edit:",t),console.error("Error response:",(e=t.response)==null?void 0:e.data),this.showError(((_=(r=t.response)==null?void 0:r.data)==null?void 0:_.message)||"Failed to load sale details")}},showSuccess(a){window.Toast?window.Toast.fire({icon:"success",title:a}):window.Swal?window.Swal.fire({icon:"success",title:a,timer:2e3,showConfirmButton:!1}):alert(a)},showError(a){window.Toast?window.Toast.fire({icon:"error",title:a}):window.Swal?window.Swal.fire({icon:"error",title:a}):alert(a)},async save(a=null){var e,r,_;if(this.cartItems.length===0){this.showError("Please add at least one product");return}if(this.$refs.formRef){const{valid:t}=await this.$refs.formRef.validate();if(!t){this.showError("Please fill in all required fields");return}}if(!this.form.customer_id){this.showError("Please select a customer");return}if(!this.form.warehouse_id){this.showError("Please select a warehouse");return}if(!this.form.invoice_date){this.showError("Please select an invoice date");return}this.saving=!0;try{const t={customer_id:Number(this.form.customer_id),warehouse_id:Number(this.form.warehouse_id),invoice_date:this.form.invoice_date,due_date:this.form.due_date||null,paid_amount:parseFloat(this.form.paid_amount)||0,discount_amount:parseFloat(this.form.discount_amount)||0,tax_amount:parseFloat(this.form.tax_amount)||0,shipping_cost:parseFloat(this.form.shipping_cost)||0,notes:this.form.notes||"",payment_method:this.paymentMethod||"cash",items:this.cartItems.map(m=>({product_id:Number(m.product_id),quantity:parseInt(m.quantity,10),unit_price:parseFloat(m.unit_price),discount:parseFloat(m.discount)||0,tax:parseFloat(m.tax)||0,notes:m.notes||""}))};a&&typeof a=="string"&&(t.status=String(a)),console.log("Saving sale with payload:",JSON.stringify(t,null,2));let o;this.isEdit?(o=await k.put(`/api/v1/sales/${this.form.id}`,t),this.showSuccess(a==="draft"?"Sale draft updated successfully":"Sale updated successfully")):(o=await k.post("/api/v1/sales",t),this.showSuccess(a==="draft"?"Sale saved as draft successfully":"Sale created successfully")),console.log("Sale saved successfully:",o.data),this.$emit("saved"),this.close()}catch(t){console.error("Failed to save sale:",t),console.error("Error response:",(e=t.response)==null?void 0:e.data),console.error("Error status:",(r=t.response)==null?void 0:r.status);let o="Failed to save sale. Please check the console for details.";(_=t.response)!=null&&_.data?t.response.data.message?o=t.response.data.message:t.response.data.error?o=t.response.data.error:t.response.data.errors&&(o=Object.values(t.response.data.errors).flat().join(", ")):t.message&&(o=t.message),this.showError(o)}finally{this.saving=!1}},async saveAsDraft(){await this.save("draft")},close(){this.$emit("update:modelValue",!1),this.form=this.getEmptyForm(),this.cartItems=[],this.searchResults=[]}}},ae={class:"d-flex align-center gap-2"},le={class:"text-h6 text-white font-weight-medium"},se={key:0,class:"search-results-container"},oe={class:"text-body-2 font-weight-medium"},ne={class:"text-body-2"},ie={class:"pa-1"},re={class:"pa-1"},de={class:"pa-1"},ue={class:"pa-1"},ce={class:"text-body-2 font-weight-bold text-end"},me={class:"text-center"},pe={class:"mb-2"},_e={class:"mb-2"},fe={class:"totals-section"},he={class:"d-flex justify-space-between mb-1"},ve={class:"text-body-2 font-weight-medium"},ge={class:"d-flex justify-space-between mb-1"},ye={class:"d-flex justify-space-between mb-1"},we={class:"d-flex justify-space-between mb-2"},xe={class:"d-flex justify-space-between mb-2 total-amount"},be={class:"text-h6 font-weight-bold text-primary"},Se={class:"mb-2"},Ve={class:"mb-2"},De={key:0,class:"mb-2"};function Fe(a,e,r,_,t,o){const m=i("v-icon"),g=i("v-btn"),y=i("v-card-title"),f=i("v-text-field"),w=i("v-img"),D=i("v-avatar"),E=i("v-list-item-title"),P=i("v-list-item-subtitle"),C=i("v-chip"),N=i("v-list-item"),q=i("v-list"),I=i("v-card-text"),T=i("v-card"),F=i("v-divider"),U=i("v-table"),c=i("v-alert"),x=i("v-col"),j=i("v-autocomplete"),O=i("v-select"),A=i("DatePickerVuetifyInput"),R=i("v-row"),W=i("v-textarea"),H=i("v-form"),Q=i("v-card-actions"),G=i("v-dialog");return p(),V(G,{"model-value":r.modelValue,"onUpdate:modelValue":e[14]||(e[14]=d=>a.$emit("update:modelValue",d)),"max-width":"1400px",persistent:"",scrollable:""},{default:n(()=>[s(T,{class:"pos-dialog"},{default:n(()=>[s(y,{class:"pos-header d-flex justify-space-between align-center pa-3"},{default:n(()=>[l("div",ae,[s(m,{color:"white"},{default:n(()=>e[15]||(e[15]=[h("mdi-point-of-sale")])),_:1,__:[15]}),l("span",le,u(o.isEdit?"Edit Sale":"New Sale - POS"),1)]),s(g,{icon:"mdi-close",variant:"text",color:"white",size:"small",onClick:o.close},null,8,["onClick"])]),_:1}),s(I,{class:"pa-3"},{default:n(()=>[s(H,{ref:"formRef",modelValue:t.formValid,"onUpdate:modelValue":e[13]||(e[13]=d=>t.formValid=d)},{default:n(()=>[s(R,{dense:"",class:"ma-0"},{default:n(()=>[s(x,{cols:"12",lg:"8",class:"pa-2"},{default:n(()=>[s(T,{variant:"flat",class:"mb-3 search-card",elevation:"1"},{default:n(()=>[s(I,{class:"pa-3"},{default:n(()=>[s(f,{modelValue:t.productSearch,"onUpdate:modelValue":e[0]||(e[0]=d=>t.productSearch=d),label:"Search Product (Name/SKU/Barcode)","prepend-inner-icon":"mdi-magnify",clearable:"",autofocus:"",variant:"outlined","hide-details":"",onKeyup:X(o.searchProducts,["enter"]),"onClick:clear":e[1]||(e[1]=d=>t.searchResults=[])},null,8,["modelValue","onKeyup"]),t.searchResults.length>0?(p(),v("div",se,[s(q,{class:"search-results"},{default:n(()=>[(p(!0),v(z,null,Y(t.searchResults,d=>(p(),V(N,{key:d.id,onClick:M=>o.addToCart(d),class:"search-item"},{prepend:n(()=>[s(D,{size:"40",color:"grey-lighten-4"},{default:n(()=>[d.image?(p(),V(w,{key:0,src:d.image},null,8,["src"])):(p(),V(m,{key:1},{default:n(()=>e[16]||(e[16]=[h("mdi-package-variant")])),_:1,__:[16]}))]),_:2},1024)]),append:n(()=>[s(C,{color:"primary",size:"small",variant:"flat"},{default:n(()=>[h("৳"+u(d.sale_price),1)]),_:2},1024)]),default:n(()=>[s(E,null,{default:n(()=>[h(u(d.name),1)]),_:2},1024),s(P,null,{default:n(()=>[h(" SKU: "+u(d.sku||"N/A")+" | Stock: "+u(d.stock_quantity||0),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})])):S("",!0)]),_:1})]),_:1}),s(T,{variant:"flat",class:"cart-card",elevation:"1"},{default:n(()=>[s(y,{class:"cart-header pa-2"},{default:n(()=>[s(m,{size:"18",class:"mr-1"},{default:n(()=>e[17]||(e[17]=[h("mdi-cart")])),_:1,__:[17]}),l("span",oe,"Cart Items ("+u(t.cartItems.length)+")",1)]),_:1}),s(F),s(I,{class:"pa-2"},{default:n(()=>[t.cartItems.length>0?(p(),V(U,{key:0,density:"compact",class:"cart-table"},{default:n(()=>[e[18]||(e[18]=l("thead",null,[l("tr",null,[l("th",{class:"text-caption"},"Product"),l("th",{class:"text-caption text-center",style:{width:"70px"}},"Qty"),l("th",{class:"text-caption text-end",style:{width:"90px"}},"Price"),l("th",{class:"text-caption text-end",style:{width:"80px"}},"Disc."),l("th",{class:"text-caption text-end",style:{width:"80px"}},"Tax"),l("th",{class:"text-caption text-end",style:{width:"100px"}},"Total"),l("th",{class:"text-caption",style:{width:"40px"}})])],-1)),l("tbody",null,[(p(!0),v(z,null,Y(t.cartItems,(d,M)=>(p(),v("tr",{key:M,class:"cart-row"},[l("td",ne,u(d.product_name),1),l("td",ie,[s(f,{modelValue:d.quantity,"onUpdate:modelValue":[b=>d.quantity=b,b=>o.updateCartItem(M)],modelModifiers:{number:!0},type:"number",min:"1",density:"compact","hide-details":"",variant:"outlined",class:"cart-input"},null,8,["modelValue","onUpdate:modelValue"])]),l("td",re,[s(f,{modelValue:d.unit_price,"onUpdate:modelValue":[b=>d.unit_price=b,b=>o.updateCartItem(M)],modelModifiers:{number:!0},type:"number",min:"0",step:"0.01",density:"compact","hide-details":"",variant:"outlined",class:"cart-input"},null,8,["modelValue","onUpdate:modelValue"])]),l("td",de,[s(f,{modelValue:d.discount,"onUpdate:modelValue":[b=>d.discount=b,b=>o.updateCartItem(M)],modelModifiers:{number:!0},type:"number",min:"0",step:"0.01",density:"compact","hide-details":"",variant:"outlined",class:"cart-input"},null,8,["modelValue","onUpdate:modelValue"])]),l("td",ue,[s(f,{modelValue:d.tax,"onUpdate:modelValue":[b=>d.tax=b,b=>o.updateCartItem(M)],modelModifiers:{number:!0},type:"number",min:"0",step:"0.01",density:"compact","hide-details":"",variant:"outlined",class:"cart-input"},null,8,["modelValue","onUpdate:modelValue"])]),l("td",ce,"৳"+u(d.total.toFixed(2)),1),l("td",me,[s(g,{icon:"mdi-delete",size:"x-small",variant:"text",color:"error",onClick:b=>o.removeFromCart(M)},null,8,["onClick"])])]))),128))])]),_:1,__:[18]})):(p(),V(c,{key:1,type:"info",variant:"tonal",density:"compact",class:"mt-2 mb-0"},{default:n(()=>e[19]||(e[19]=[l("span",{class:"text-caption"},"Cart is empty. Search and add products.",-1)])),_:1,__:[19]}))]),_:1})]),_:1})]),_:1}),s(x,{cols:"12",lg:"4",class:"pa-2"},{default:n(()=>[s(T,{variant:"flat",class:"details-card",elevation:"1"},{default:n(()=>[s(I,{class:"pa-2"},{default:n(()=>[l("div",pe,[s(j,{modelValue:t.form.customer_id,"onUpdate:modelValue":e[2]||(e[2]=d=>t.form.customer_id=d),items:t.customers,"item-value":"id","item-title":"name",label:"Customer *",clearable:"",density:"compact",variant:"outlined","hide-details":"",rules:[t.rules.required]},{"prepend-inner":n(()=>[s(m,{size:"18"},{default:n(()=>e[20]||(e[20]=[h("mdi-account")])),_:1,__:[20]})]),_:1},8,["modelValue","items","rules"])]),l("div",_e,[s(O,{modelValue:t.form.warehouse_id,"onUpdate:modelValue":e[3]||(e[3]=d=>t.form.warehouse_id=d),items:t.warehouses,"item-value":"id","item-title":"name",label:"Warehouse *",density:"compact",variant:"outlined","hide-details":"",rules:[t.rules.required]},{"prepend-inner":n(()=>[s(m,{size:"18"},{default:n(()=>e[21]||(e[21]=[h("mdi-warehouse")])),_:1,__:[21]})]),_:1},8,["modelValue","items","rules"])]),s(R,{dense:"",class:"ma-0 mb-2"},{default:n(()=>[s(x,{cols:"6",class:"pa-1"},{default:n(()=>[s(A,{fieldLabel:"Invoice Date",required:"true",variant:"outlined",initialDate:t.form.invoice_date,onTrigerInputValue:e[4]||(e[4]=d=>{t.form.invoice_date=d})},null,8,["initialDate"])]),_:1}),s(x,{cols:"6",class:"pa-1"},{default:n(()=>[s(A,{fieldLabel:"Due Date",variant:"outlined",initialDate:t.form.due_date,onTrigerInputValue:e[5]||(e[5]=d=>{t.form.due_date=d})},null,8,["initialDate"])]),_:1})]),_:1}),s(F,{class:"my-2"}),l("div",fe,[l("div",he,[e[22]||(e[22]=l("span",{class:"text-caption text-grey"},"Subtotal:",-1)),l("span",ve,"৳"+u(t.form.subtotal.toFixed(2)),1)]),l("div",ge,[e[23]||(e[23]=l("span",{class:"text-caption text-grey"},"Discount:",-1)),s(f,{modelValue:t.form.discount_amount,"onUpdate:modelValue":[e[6]||(e[6]=d=>t.form.discount_amount=d),o.calculateTotals],modelModifiers:{number:!0},type:"number",density:"compact",variant:"outlined","hide-details":"",min:"0",step:"0.01",class:"compact-input"},null,8,["modelValue","onUpdate:modelValue"])]),l("div",ye,[e[24]||(e[24]=l("span",{class:"text-caption text-grey"},"Tax:",-1)),s(f,{modelValue:t.form.tax_amount,"onUpdate:modelValue":[e[7]||(e[7]=d=>t.form.tax_amount=d),o.calculateTotals],modelModifiers:{number:!0},type:"number",density:"compact",variant:"outlined","hide-details":"",min:"0",step:"0.01",class:"compact-input"},null,8,["modelValue","onUpdate:modelValue"])]),l("div",we,[e[25]||(e[25]=l("span",{class:"text-caption text-grey"},"Shipping:",-1)),s(f,{modelValue:t.form.shipping_cost,"onUpdate:modelValue":[e[8]||(e[8]=d=>t.form.shipping_cost=d),o.calculateTotals],modelModifiers:{number:!0},type:"number",density:"compact",variant:"outlined","hide-details":"",min:"0",step:"0.01",class:"compact-input"},null,8,["modelValue","onUpdate:modelValue"])]),s(F,{class:"my-2"}),l("div",xe,[e[26]||(e[26]=l("span",{class:"text-body-1 font-weight-bold"},"Total:",-1)),l("span",be,"৳"+u(t.form.total_amount.toFixed(2)),1)]),l("div",Se,[s(f,{modelValue:t.form.paid_amount,"onUpdate:modelValue":[e[9]||(e[9]=d=>t.form.paid_amount=d),o.calculateBalance],modelModifiers:{number:!0},type:"number",label:"Paid Amount",density:"compact",variant:"outlined",min:"0",step:"0.01","prepend-inner-icon":"mdi-cash"},null,8,["modelValue","onUpdate:modelValue"])]),l("div",Ve,[s(f,{modelValue:t.form.balance_amount,"onUpdate:modelValue":e[10]||(e[10]=d=>t.form.balance_amount=d),modelModifiers:{number:!0},label:"Balance (Due)",density:"compact",variant:"outlined",readonly:"",color:t.form.balance_amount>0?"error":"success",class:K(t.form.balance_amount>0?"text-error":"text-success")},null,8,["modelValue","color","class"])]),t.form.paid_amount>0?(p(),v("div",De,[s(O,{modelValue:t.paymentMethod,"onUpdate:modelValue":e[11]||(e[11]=d=>t.paymentMethod=d),items:t.paymentMethods,label:"Payment Method",density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue","items"])])):S("",!0)]),s(F,{class:"my-2"}),s(W,{modelValue:t.form.notes,"onUpdate:modelValue":e[12]||(e[12]=d=>t.form.notes=d),label:"Notes",rows:"2",density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(F),s(Q,{class:"pa-2 justify-end"},{default:n(()=>[s(g,{variant:"text",size:"small",onClick:o.close},{default:n(()=>e[27]||(e[27]=[h("Cancel")])),_:1,__:[27]},8,["onClick"]),o.isEdit?S("",!0):(p(),V(g,{key:0,color:"grey",size:"small",loading:t.saving,disabled:t.cartItems.length===0,onClick:o.saveAsDraft},{default:n(()=>[s(m,{size:"18",class:"mr-1"},{default:n(()=>e[28]||(e[28]=[h("mdi-content-save-outline")])),_:1,__:[28]}),e[29]||(e[29]=h(" Save as Draft "))]),_:1,__:[29]},8,["loading","disabled","onClick"])),s(g,{color:"success",size:"small",loading:t.saving,disabled:t.cartItems.length===0,onClick:o.save},{default:n(()=>[s(m,{size:"18",class:"mr-1"},{default:n(()=>e[30]||(e[30]=[h("mdi-content-save")])),_:1,__:[30]}),h(" "+u(o.isEdit?"Update":"Save Sale"),1)]),_:1},8,["loading","disabled","onClick"])]),_:1})]),_:1})]),_:1},8,["model-value"])}const ke=B(te,[["render",Fe],["__scopeId","data-v-fd1754d3"]]);function Ce(a){if(!a)return"";try{const e=new Date(a);if(isNaN(e.getTime()))return"";const r=String(e.getDate()).padStart(2,"0"),t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],o=e.getFullYear();return`${r}/${t}/${o}`}catch{return a}}function Ie(a){if(!a)return"";try{if(typeof a=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(a)){const[o,m,g]=a.split("-");return`${g}/${m}/${o}`}const e=new Date(a);if(isNaN(e.getTime()))return"";const r=String(e.getDate()).padStart(2,"0"),_=String(e.getMonth()+1).padStart(2,"0"),t=e.getFullYear();return`${r}/${_}/${t}`}catch{return a}}const Te={name:"ViewSaleDialog",props:{modelValue:{type:Boolean,required:!0},sale:{type:Object,default:null}},emits:["update:modelValue"],data(){return{saleData:null,loading:!1,currentSaleId:null}},watch:{modelValue:{immediate:!0,handler(a){a&&this.sale&&this.sale.id?this.currentSaleId!==this.sale.id&&this.loadSaleDetails(this.sale.id):a||(this.saleData=null,this.currentSaleId=null)}},sale:{immediate:!0,handler(a){a&&a.id&&this.modelValue&&this.currentSaleId!==a.id&&this.loadSaleDetails(a.id)}}},methods:{async loadSaleDetails(a){var e,r,_;if(!a){console.error("No sale ID provided");return}if(!(this.currentSaleId===a&&this.saleData)){this.currentSaleId=a,this.loading=!0,this.saleData=null;try{const{data:t}=await k.get(`/api/v1/sales/${a}`);this.saleData=t.data||t.sale||t,this.saleData||(this.showError("Sale data not found"),this.currentSaleId=null)}catch(t){console.error("Failed to load sale details:",t),console.error("Error response:",(e=t.response)==null?void 0:e.data),this.showError(((_=(r=t.response)==null?void 0:r.data)==null?void 0:_.message)||"Failed to load sale details"),this.currentSaleId=null}finally{this.loading=!1}}},formatDate:Ce,getStatusColor(a){return{draft:"grey",pending:"warning",partial:"info",paid:"success",cancelled:"error"}[a]||"grey"},printInvoice(){window.print()},close(){this.$emit("update:modelValue",!1),this.saleData=null,this.currentSaleId=null},showError(a){window.Toast?window.Toast.fire({icon:"error",title:a}):window.Swal?window.Swal.fire({icon:"error",title:a}):alert(a)}}},Ue={class:"text-h5 text-white"},Pe={key:0},Me={key:1},Ee={key:0,class:"text-center py-8"},qe={key:1,class:"text-center py-8"},Ne={key:2},je={class:"text-h6"},Be={class:"text-caption"},ze={class:"text-body-1"},Ye={key:0},Oe={class:"text-right"},Ae={class:"text-right"},Re={class:"text-right"},Le={class:"text-right"},Ke={class:"text-right font-weight-bold"},Je={class:"d-flex justify-space-between mb-2"},We={key:0,class:"d-flex justify-space-between mb-2"},He={class:"text-error"},Qe={key:1,class:"d-flex justify-space-between mb-2"},Ge={key:2,class:"d-flex justify-space-between mb-2"},Xe={class:"d-flex justify-space-between text-h6 mb-2"},Ze={class:"d-flex justify-space-between text-success mb-2"},$e={class:"text-caption mt-4"};function et(a,e,r,_,t,o){const m=i("v-icon"),g=i("v-btn"),y=i("v-card-title"),f=i("v-progress-circular"),w=i("v-alert"),D=i("v-col"),E=i("v-chip"),P=i("v-row"),C=i("v-divider"),N=i("v-table"),q=i("v-card-text"),I=i("v-card-actions"),T=i("v-card"),F=i("v-dialog");return p(),V(F,{"model-value":r.modelValue,"onUpdate:modelValue":e[0]||(e[0]=U=>a.$emit("update:modelValue",U)),"max-width":"900px",persistent:""},{default:n(()=>[s(T,null,{default:n(()=>[s(y,{class:"d-flex justify-space-between align-center bg-primary"},{default:n(()=>[l("span",Ue,[s(m,{class:"text-white"},{default:n(()=>e[1]||(e[1]=[h("mdi-file-document")])),_:1,__:[1]}),t.saleData?(p(),v("span",Pe,"Sale Invoice: "+u(t.saleData.invoice_number),1)):(p(),v("span",Me,"Loading Sale Details..."))]),s(g,{icon:"mdi-close",variant:"text",class:"text-white",onClick:o.close},null,8,["onClick"])]),_:1}),s(q,{class:"pa-6"},{default:n(()=>{var U;return[t.loading?(p(),v("div",Ee,[s(f,{indeterminate:"",color:"primary",size:"64"}),e[2]||(e[2]=l("div",{class:"mt-4"},"Loading sale details...",-1))])):t.saleData?(p(),v("div",Ne,[s(P,{class:"mb-4"},{default:n(()=>[s(D,{cols:"6"},{default:n(()=>{var c,x;return[e[4]||(e[4]=l("div",{class:"text-subtitle-2"},"Customer",-1)),l("div",je,u(((c=t.saleData.customer)==null?void 0:c.name)||"Walk-in"),1),l("div",Be,u(((x=t.saleData.customer)==null?void 0:x.phone)||""),1)]}),_:1,__:[4]}),s(D,{cols:"6",class:"text-right"},{default:n(()=>[e[5]||(e[5]=l("div",{class:"text-subtitle-2"},"Date",-1)),l("div",ze,u(o.formatDate(t.saleData.invoice_date)),1),s(E,{color:o.getStatusColor(t.saleData.status),size:"small",class:"mt-2"},{default:n(()=>[h(u(t.saleData.status),1)]),_:1},8,["color"])]),_:1,__:[5]})]),_:1}),s(C,{class:"my-4"}),s(N,{density:"compact"},{default:n(()=>[e[7]||(e[7]=l("thead",null,[l("tr",null,[l("th",null,"Product"),l("th",{class:"text-right"},"Qty"),l("th",{class:"text-right"},"Price"),l("th",{class:"text-right"},"Discount"),l("th",{class:"text-right"},"Tax"),l("th",{class:"text-right"},"Total")])],-1)),l("tbody",null,[!t.saleData.items||t.saleData.items.length===0?(p(),v("tr",Ye,e[6]||(e[6]=[l("td",{colspan:"6",class:"text-center py-4 text-grey"},"No items found",-1)]))):S("",!0),(p(!0),v(z,null,Y(t.saleData.items||[],c=>{var x;return p(),v("tr",{key:c.id||c.product_id},[l("td",null,u(((x=c.product)==null?void 0:x.name)||"Unknown"),1),l("td",Oe,u(c.quantity),1),l("td",Ae,"৳"+u(parseFloat(c.unit_price||0).toFixed(2)),1),l("td",Re,"৳"+u(parseFloat(c.discount||0).toFixed(2)),1),l("td",Le,"৳"+u(parseFloat(c.tax||0).toFixed(2)),1),l("td",Ke,"৳"+u(parseFloat(c.total||0).toFixed(2)),1)])}),128))])]),_:1,__:[7]}),s(C,{class:"my-4"}),s(P,null,{default:n(()=>[s(D,{cols:"6",offset:"6"},{default:n(()=>[l("div",Je,[e[8]||(e[8]=l("span",null,"Subtotal:",-1)),l("span",null,"৳"+u(parseFloat(t.saleData.subtotal).toFixed(2)),1)]),t.saleData.discount_amount>0?(p(),v("div",We,[e[9]||(e[9]=l("span",null,"Discount:",-1)),l("span",He,"-৳"+u(parseFloat(t.saleData.discount_amount).toFixed(2)),1)])):S("",!0),t.saleData.tax_amount>0?(p(),v("div",Qe,[e[10]||(e[10]=l("span",null,"Tax:",-1)),l("span",null,"৳"+u(parseFloat(t.saleData.tax_amount).toFixed(2)),1)])):S("",!0),t.saleData.shipping_cost>0?(p(),v("div",Ge,[e[11]||(e[11]=l("span",null,"Shipping:",-1)),l("span",null,"৳"+u(parseFloat(t.saleData.shipping_cost).toFixed(2)),1)])):S("",!0),s(C,{class:"my-2"}),l("div",Xe,[e[12]||(e[12]=l("span",null,"Total:",-1)),l("span",null,"৳"+u(parseFloat(t.saleData.total_amount).toFixed(2)),1)]),l("div",Ze,[e[13]||(e[13]=l("span",null,"Paid:",-1)),l("span",null,"৳"+u(parseFloat(t.saleData.paid_amount).toFixed(2)),1)]),l("div",{class:K(["d-flex justify-space-between font-weight-bold",t.saleData.balance_amount>0?"text-error":"text-success"])},[e[14]||(e[14]=l("span",null,"Balance:",-1)),l("span",null,"৳"+u(parseFloat(t.saleData.balance_amount).toFixed(2)),1)],2)]),_:1})]),_:1}),t.saleData.notes?(p(),V(w,{key:0,type:"info",variant:"tonal",class:"mt-4"},{default:n(()=>[e[15]||(e[15]=l("strong",null,"Notes:",-1)),h(" "+u(t.saleData.notes),1)]),_:1,__:[15]})):S("",!0),l("div",$e,[e[16]||(e[16]=l("strong",null,"Warehouse:",-1)),h(" "+u(((U=t.saleData.warehouse)==null?void 0:U.name)||"N/A"),1)])])):(p(),v("div",qe,[s(w,{type:"error",variant:"tonal"},{default:n(()=>e[3]||(e[3]=[h(" Failed to load sale details ")])),_:1,__:[3]})]))]}),_:1}),s(C),s(I,{class:"justify-end pa-4"},{default:n(()=>[s(g,{color:"primary","prepend-icon":"mdi-printer",onClick:o.printInvoice},{default:n(()=>e[17]||(e[17]=[h(" Print Invoice ")])),_:1,__:[17]},8,["onClick"]),s(g,{variant:"text",onClick:o.close},{default:n(()=>e[18]||(e[18]=[h("Close")])),_:1,__:[18]},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["model-value"])}const tt=B(Te,[["render",et]]),at={name:"DatePicker",props:{modelValue:{type:[String,Date],default:null},label:{type:String,default:"Date"},rules:{type:Array,default:()=>[]},required:{type:Boolean,default:!1},fieldClass:{type:String,default:""},density:{type:String,default:"default"},variant:{type:String,default:"outlined"}},emits:["update:modelValue"],data(){return{dateMenu:!1}},computed:{formattedDate(){if(!this.modelValue)return"";try{let a;if(typeof this.modelValue=="string")/^\d{4}-\d{2}-\d{2}$/.test(this.modelValue)?a=this.modelValue:this.modelValue.includes("T")?a=this.modelValue.split("T")[0]:a=this.modelValue;else{const t=this.modelValue.getFullYear(),o=String(this.modelValue.getMonth()+1).padStart(2,"0"),m=String(this.modelValue.getDate()).padStart(2,"0");a=`${t}-${o}-${m}`}const[e,r,_]=a.split("-").map(Number);return isNaN(e)||isNaN(r)||isNaN(_)?this.modelValue:`${String(_).padStart(2,"0")}/${String(r).padStart(2,"0")}/${e}`}catch{return this.modelValue}},datePickerValue(){if(!this.modelValue)return null;try{let a;if(typeof this.modelValue=="string"){if(/^\d{4}-\d{2}-\d{2}$/.test(this.modelValue))return this.modelValue;this.modelValue.includes("T")?a=this.modelValue.split("T")[0]:a=this.modelValue}else{const e=this.modelValue.getFullYear(),r=String(this.modelValue.getMonth()+1).padStart(2,"0"),_=String(this.modelValue.getDate()).padStart(2,"0");a=`${e}-${r}-${_}`}return/^\d{4}-\d{2}-\d{2}$/.test(a)?a:this.modelValue}catch{return this.modelValue}}},methods:{onDateSelected(a){if(a&&/^\d{4}-\d{2}-\d{2}$/.test(a))this.$emit("update:modelValue",String(a));else if(a)try{if(typeof a=="string"&&a.includes("T")){const e=a.split("T")[0];if(/^\d{4}-\d{2}-\d{2}$/.test(e))this.$emit("update:modelValue",e);else{const r=new Date(a),_=r.getFullYear(),t=String(r.getMonth()+1).padStart(2,"0"),o=String(r.getDate()).padStart(2,"0");this.$emit("update:modelValue",`${_}-${t}-${o}`)}}else{const e=new Date(a),r=e.getFullYear(),_=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0");this.$emit("update:modelValue",`${r}-${_}-${t}`)}}catch{this.$emit("update:modelValue",a)}else this.$emit("update:modelValue",null);this.dateMenu=!1},clearDate(){this.$emit("update:modelValue",null)}}};function lt(a,e,r,_,t,o){const m=i("v-text-field"),g=i("v-date-picker"),y=i("v-menu");return p(),V(y,{modelValue:t.dateMenu,"onUpdate:modelValue":e[1]||(e[1]=f=>t.dateMenu=f),"close-on-content-click":!1,location:"bottom",transition:"scale-transition"},{activator:n(({props:f})=>[s(m,L({"model-value":o.formattedDate,label:r.label,readonly:""},f,{rules:r.rules,required:r.required,class:r.fieldClass,"prepend-inner-icon":"mdi-calendar",density:r.density,variant:r.variant,clearable:"","onClick:clear":o.clearDate,"onUpdate:modelValue":e[0]||(e[0]=w=>a.$emit("update:modelValue",w))}),null,16,["model-value","label","rules","required","class","density","variant","onClick:clear"])]),default:n(()=>[s(g,{"model-value":o.datePickerValue,"onUpdate:modelValue":o.onDateSelected,color:"primary","show-adjacent-months":"","hide-header":""},null,8,["model-value","onUpdate:modelValue"])]),_:1},8,["modelValue"])}const st=B(at,[["render",lt],["__scopeId","data-v-c69c332a"]]),ot={name:"AdminSales",mixins:[J],components:{SaleDialog:ke,ViewSaleDialog:tt,DatePicker:st},data(){return{sales:[],loading:!1,dialog:!1,viewDialog:!1,selectedSale:null,filters:{search:"",status:null,date_from:"",date_to:""},pagination:{current_page:1,per_page:15,last_page:1,total:0},perPageOptions:[{title:"10",value:10},{title:"15",value:15},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100}],statusOptions:[{title:"Draft",value:"draft"},{title:"Pending",value:"pending"},{title:"Partial",value:"partial"},{title:"Paid",value:"paid"},{title:"Cancelled",value:"cancelled"}]}},mounted(){this.fetchSales()},methods:{async fetchSales(){this.loading=!0;try{const a={page:this.pagination.current_page,per_page:this.pagination.per_page,search:this.filters.search||"",status:this.filters.status||null};this.filters.date_from&&String(this.filters.date_from).trim()!==""&&(a.from_date=this.filters.date_from),this.filters.date_to&&String(this.filters.date_to).trim()!==""&&(a.to_date=this.filters.date_to);const{data:e}=await k.get("/api/v1/sales",{params:a});this.sales=e.data||e.sales||[],this.pagination={current_page:e.current_page||1,per_page:e.per_page||15,last_page:e.last_page||1,total:e.total||0}}catch(a){console.error("Failed to fetch sales",a),this.showError("Failed to load sales")}finally{this.loading=!1}},openDialog(){this.selectedSale=null,this.dialog=!0},editSale(a){this.selectedSale=a,this.dialog=!0},viewSale(a){this.selectedSale=a,this.viewDialog=!0},async confirmDelete(a){var r,_;if(this.selectedSale=a,(await window.Swal.fire({title:"Are you sure?",text:`Do you want to delete sale ${a.invoice_number}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"})).isConfirmed)try{await k.delete(`/api/v1/sales/${a.id}`),this.showSuccess("Sale deleted successfully"),this.fetchSales()}catch(t){console.error("Failed to delete sale",t),this.showError(((_=(r=t.response)==null?void 0:r.data)==null?void 0:_.message)||"Failed to delete sale")}},printInvoice(a){console.log("Print invoice:",a.invoice_number),this.showInfo("Print feature coming soon")},handleSaved(){this.fetchSales()},resetFilters(){this.filters={search:"",status:null,date_from:"",date_to:""},this.pagination.current_page=1,this.fetchSales()},onPerPageChange(){this.pagination.current_page=1,this.fetchSales()},onDateFromChange(a){this.filters.date_from=a||"",this.pagination.current_page=1,this.fetchSales()},onDateToChange(a){this.filters.date_to=a||"",this.pagination.current_page=1,this.fetchSales()},formatDateDDMMYYYY:Ie,getStatusColor(a){return{draft:"grey",pending:"warning",partial:"info",paid:"success",cancelled:"error"}[a]||"grey"},showSuccess(a){window.Toast?window.Toast.fire({icon:"success",title:a}):window.Swal?window.Swal.fire({icon:"success",title:a,timer:2e3,showConfirmButton:!1}):alert(a)},showError(a){window.Toast?window.Toast.fire({icon:"error",title:a}):window.Swal?window.Swal.fire({icon:"error",title:a}):alert(a)},showInfo(a){window.Toast?window.Toast.fire({icon:"info",title:a}):window.Swal?window.Swal.fire({icon:"info",title:a,timer:2e3,showConfirmButton:!1}):alert(a)}}},nt={class:"page-header"},it={class:"text-caption text-grey"},rt={key:0},dt={key:0,class:"text-center py-4"},ut={class:"font-weight-bold"},ct={class:"text-end"},mt={class:"text-end"},pt={class:"text-end"},_t={key:0},ft={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},ht={class:"text-caption text-grey"},vt={key:0},gt={key:0,class:"ml-2"},yt={key:1},wt={key:0,class:"d-flex align-center gap-2"};function xt(a,e,r,_,t,o){const m=i("v-btn"),g=i("v-select"),y=i("v-col"),f=i("DatePicker"),w=i("v-text-field"),D=i("v-row"),E=i("v-card-text"),P=i("v-card"),C=i("v-card-title"),N=i("v-progress-circular"),q=i("v-chip"),I=i("v-table"),T=i("v-pagination"),F=i("SaleDialog"),U=i("ViewSaleDialog");return p(),v("div",null,[l("div",nt,[e[9]||(e[9]=l("h1",{class:"text-h4 page-title"},"Sales / POS",-1)),s(m,{color:"primary","prepend-icon":"mdi-plus",onClick:o.openDialog,class:"add-button"},{default:n(()=>e[8]||(e[8]=[h(" New Sale ")])),_:1,__:[8]},8,["onClick"])]),s(P,{class:"mb-4"},{default:n(()=>[s(E,null,{default:n(()=>[s(D,null,{default:n(()=>[s(y,{cols:"12",md:"3"},{default:n(()=>[s(g,{modelValue:t.pagination.per_page,"onUpdate:modelValue":[e[0]||(e[0]=c=>t.pagination.per_page=c),o.onPerPageChange],items:t.perPageOptions,label:"Items per page","prepend-inner-icon":"mdi-format-list-numbered",variant:"outlined",density:"compact"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),s(y,{cols:"12",md:"2"},{default:n(()=>[s(g,{modelValue:t.filters.status,"onUpdate:modelValue":[e[1]||(e[1]=c=>t.filters.status=c),o.fetchSales],items:t.statusOptions,label:"Status","prepend-inner-icon":"mdi-filter",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),s(y,{cols:"12",md:"2"},{default:n(()=>[s(f,{modelValue:t.filters.date_from,"onUpdate:modelValue":[e[2]||(e[2]=c=>t.filters.date_from=c),o.onDateFromChange],label:"From Date",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(y,{cols:"12",md:"2"},{default:n(()=>[s(f,{modelValue:t.filters.date_to,"onUpdate:modelValue":[e[3]||(e[3]=c=>t.filters.date_to=c),o.onDateToChange],label:"To Date",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(y,{cols:"12",md:"3"},{default:n(()=>[s(w,{modelValue:t.filters.search,"onUpdate:modelValue":[e[4]||(e[4]=c=>t.filters.search=c),o.fetchSales],label:"Search Invoice/Customer","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),s(P,null,{default:n(()=>[s(C,{class:"d-flex justify-space-between align-center"},{default:n(()=>[e[11]||(e[11]=l("span",null,"Sales",-1)),l("span",it,[e[10]||(e[10]=h(" Total Records: ")),l("strong",null,u(t.pagination.total||0),1),t.sales.length>0?(p(),v("span",rt," | Showing "+u((t.pagination.current_page-1)*t.pagination.per_page+1)+" to "+u(Math.min(t.pagination.current_page*t.pagination.per_page,t.pagination.total))+" of "+u(t.pagination.total),1)):S("",!0)])]),_:1,__:[11]}),s(E,null,{default:n(()=>[t.loading?(p(),v("div",dt,[s(N,{indeterminate:"",color:"primary"})])):(p(),V(I,{key:1},{default:n(()=>[e[13]||(e[13]=l("thead",null,[l("tr",null,[l("th",null,"Invoice #"),l("th",null,"Customer"),l("th",null,"Date"),l("th",{class:"text-end"},"Total"),l("th",{class:"text-end"},"Paid"),l("th",{class:"text-end"},"Due"),l("th",null,"Status"),l("th",null,"Actions")])],-1)),l("tbody",null,[(p(!0),v(z,null,Y(t.sales,c=>{var x;return p(),v("tr",{key:c.id},[l("td",null,[l("span",ut,u(c.invoice_number),1)]),l("td",null,u(((x=c.customer)==null?void 0:x.name)||"Walk-in"),1),l("td",null,u(o.formatDateDDMMYYYY(c.invoice_date)),1),l("td",ct," ৳"+u(parseFloat(c.total_amount).toFixed(2)),1),l("td",mt," ৳"+u(parseFloat(c.paid_amount).toFixed(2)),1),l("td",pt,[s(q,{color:c.balance_amount>0?"error":"success",size:"small"},{default:n(()=>[h(" ৳"+u(parseFloat(c.balance_amount).toFixed(2)),1)]),_:2},1032,["color"])]),l("td",null,[s(q,{color:o.getStatusColor(c.status),size:"small"},{default:n(()=>[h(u(c.status),1)]),_:2},1032,["color"])]),l("td",null,[s(m,{icon:"mdi-eye",size:"small",variant:"text",onClick:j=>o.viewSale(c)},null,8,["onClick"]),s(m,{icon:"mdi-pencil",size:"small",variant:"text",onClick:j=>o.editSale(c)},null,8,["onClick"]),s(m,{icon:"mdi-printer",size:"small",variant:"text",onClick:j=>o.printInvoice(c)},null,8,["onClick"]),s(m,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:j=>o.confirmDelete(c)},null,8,["onClick"])])])}),128)),t.sales.length===0?(p(),v("tr",_t,e[12]||(e[12]=[l("td",{colspan:"8",class:"text-center py-4"},"No sales found",-1)]))):S("",!0)])]),_:1,__:[13]})),l("div",ft,[l("div",ht,[t.sales.length>0&&t.pagination.total>0?(p(),v("span",vt,[e[14]||(e[14]=h(" Showing ")),l("strong",null,u((t.pagination.current_page-1)*t.pagination.per_page+1),1),e[15]||(e[15]=h(" to ")),l("strong",null,u(Math.min(t.pagination.current_page*t.pagination.per_page,t.pagination.total)),1),e[16]||(e[16]=h(" of ")),l("strong",null,u(t.pagination.total.toLocaleString()),1),e[17]||(e[17]=h(" records ")),t.pagination.last_page>1?(p(),v("span",gt," (Page "+u(t.pagination.current_page)+" of "+u(t.pagination.last_page)+") ",1)):S("",!0)])):(p(),v("span",yt," No records found "))]),t.pagination.last_page>1?(p(),v("div",wt,[s(T,{modelValue:t.pagination.current_page,"onUpdate:modelValue":[e[5]||(e[5]=c=>t.pagination.current_page=c),o.fetchSales],length:t.pagination.last_page,"total-visible":7,density:"comfortable"},null,8,["modelValue","length","onUpdate:modelValue"])])):S("",!0)])]),_:1})]),_:1}),s(F,{"model-value":t.dialog,"onUpdate:modelValue":e[6]||(e[6]=c=>t.dialog=c),sale:t.selectedSale,onSaved:o.handleSaved},null,8,["model-value","sale","onSaved"]),s(U,{"model-value":t.viewDialog,"onUpdate:modelValue":e[7]||(e[7]=c=>t.viewDialog=c),sale:t.selectedSale},null,8,["model-value","sale"])])}const Vt=B(ot,[["render",xt],["__scopeId","data-v-ffd6050e"]]);export{Vt as default};
