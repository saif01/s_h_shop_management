import{_ as L,d as S,w as l,a as t,r as s,b as y,f as r,t as m,i as f,o as N}from"./app-B76V_J0T.js";const q={name:"AdminUnits",data(){return{units:[],search:"",loading:!1,dialog:!1,deleteDialog:!1,saving:!1,deleting:!1,formValid:!1,form:this.getEmptyForm(),headers:[{title:"Name",key:"name"},{title:"Code",key:"code"},{title:"Description",key:"description"},{title:"Status",key:"is_active"},{title:"Created",key:"created_at"},{title:"Actions",key:"actions",sortable:!1,align:"center"}],rules:{required:n=>!!n||"Required"}}},computed:{filteredUnits(){if(!this.search)return this.units;const n=this.search.toLowerCase();return this.units.filter(e=>{var d,c;return((d=e.name)==null?void 0:d.toLowerCase().includes(n))||((c=e.code)==null?void 0:c.toLowerCase().includes(n))})},isEdit(){return!!this.form.id}},mounted(){this.fetchUnits()},methods:{getEmptyForm(){return{id:null,name:"",code:"",description:"",is_active:!0}},async fetchUnits(){var n;this.loading=!0;try{const{data:e}=await f.get("/api/v1/units");this.units=e.data||e.units||[]}catch(e){console.error("Failed to fetch units",e),(n=this.$toast)==null||n.error("Failed to load units")}finally{this.loading=!1}},openDialog(){this.form=this.getEmptyForm(),this.dialog=!0},editUnit(n){this.form={...n},this.dialog=!0},closeDialog(){this.dialog=!1,this.form=this.getEmptyForm()},async save(){var e,d,c;if((await this.$refs.formRef.validate()).valid){this.saving=!0;try{this.isEdit?(await f.put(`/api/v1/units/${this.form.id}`,this.form),(e=this.$toast)==null||e.success("Unit updated successfully")):(await f.post("/api/v1/units",this.form),(d=this.$toast)==null||d.success("Unit created successfully")),this.closeDialog(),this.fetchUnits()}catch(o){console.error("Failed to save unit",o),(c=this.$toast)==null||c.error("Failed to save unit")}finally{this.saving=!1}}},confirmDelete(n){this.form=n,this.deleteDialog=!0},async deleteUnit(){var n,e;this.deleting=!0;try{await f.delete(`/api/v1/units/${this.form.id}`),(n=this.$toast)==null||n.success("Unit deleted successfully"),this.deleteDialog=!1,this.fetchUnits()}catch(d){console.error("Failed to delete unit",d),(e=this.$toast)==null||e.error("Failed to delete unit")}finally{this.deleting=!1}},formatDate(n){return n?new Date(n).toLocaleDateString():""}}},z={class:"d-flex align-center gap-2"};function R(n,e,d,c,o,a){const k=s("v-icon"),u=s("v-btn"),_=s("v-card-title"),v=s("v-divider"),p=s("v-text-field"),g=s("v-card-text"),U=s("v-chip"),x=s("v-data-table"),h=s("v-card"),D=s("v-textarea"),w=s("v-switch"),b=s("v-form"),V=s("v-card-actions"),C=s("v-dialog"),F=s("v-spacer"),E=s("v-container");return N(),S(E,{fluid:""},{default:l(()=>[t(h,null,{default:l(()=>[t(_,{class:"d-flex justify-space-between align-center"},{default:l(()=>[y("div",z,[t(k,null,{default:l(()=>e[9]||(e[9]=[r("mdi-weight-kilogram")])),_:1,__:[9]}),e[10]||(e[10]=y("span",{class:"text-h5"},"Units",-1))]),t(u,{color:"primary","prepend-icon":"mdi-plus",onClick:a.openDialog},{default:l(()=>e[11]||(e[11]=[r("Add Unit")])),_:1,__:[11]},8,["onClick"])]),_:1}),t(v),t(g,null,{default:l(()=>[t(p,{modelValue:o.search,"onUpdate:modelValue":e[0]||(e[0]=i=>o.search=i),label:"Search Units","prepend-inner-icon":"mdi-magnify",clearable:""},null,8,["modelValue"])]),_:1}),t(x,{headers:o.headers,items:a.filteredUnits,loading:o.loading,"items-per-page":15},{"item.code":l(({item:i})=>[t(U,{size:"small"},{default:l(()=>[r(m(i.code),1)]),_:2},1024)]),"item.is_active":l(({item:i})=>[t(U,{color:i.is_active?"success":"error",size:"small"},{default:l(()=>[r(m(i.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),"item.created_at":l(({item:i})=>[r(m(a.formatDate(i.created_at)),1)]),"item.actions":l(({item:i})=>[t(u,{icon:"mdi-pencil",size:"small",variant:"text",onClick:A=>a.editUnit(i)},null,8,["onClick"]),t(u,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:A=>a.confirmDelete(i)},null,8,["onClick"])]),_:1},8,["headers","items","loading"])]),_:1}),t(C,{modelValue:o.dialog,"onUpdate:modelValue":e[6]||(e[6]=i=>o.dialog=i),"max-width":"500px",persistent:""},{default:l(()=>[t(h,null,{default:l(()=>[t(_,{class:"d-flex justify-space-between align-center"},{default:l(()=>[y("span",null,m(a.isEdit?"Edit Unit":"Add Unit"),1),t(u,{icon:"mdi-close",variant:"text",onClick:a.closeDialog},null,8,["onClick"])]),_:1}),t(v),t(g,null,{default:l(()=>[t(b,{ref:"formRef",modelValue:o.formValid,"onUpdate:modelValue":e[5]||(e[5]=i=>o.formValid=i)},{default:l(()=>[t(p,{modelValue:o.form.name,"onUpdate:modelValue":e[1]||(e[1]=i=>o.form.name=i),label:"Unit Name *",rules:[o.rules.required]},null,8,["modelValue","rules"]),t(p,{modelValue:o.form.code,"onUpdate:modelValue":e[2]||(e[2]=i=>o.form.code=i),label:"Code *",rules:[o.rules.required],hint:"e.g., KG, PCS, LTR"},null,8,["modelValue","rules"]),t(D,{modelValue:o.form.description,"onUpdate:modelValue":e[3]||(e[3]=i=>o.form.description=i),label:"Description",rows:"2"},null,8,["modelValue"]),t(w,{modelValue:o.form.is_active,"onUpdate:modelValue":e[4]||(e[4]=i=>o.form.is_active=i),label:"Active",color:"primary"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),t(v),t(V,{class:"justify-end"},{default:l(()=>[t(u,{variant:"text",onClick:a.closeDialog},{default:l(()=>e[12]||(e[12]=[r("Cancel")])),_:1,__:[12]},8,["onClick"]),t(u,{color:"primary",loading:o.saving,onClick:a.save},{default:l(()=>[r(m(a.isEdit?"Update":"Save"),1)]),_:1},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(C,{modelValue:o.deleteDialog,"onUpdate:modelValue":e[8]||(e[8]=i=>o.deleteDialog=i),"max-width":"400"},{default:l(()=>[t(h,null,{default:l(()=>[t(_,null,{default:l(()=>e[13]||(e[13]=[r("Confirm Delete")])),_:1,__:[13]}),t(g,null,{default:l(()=>e[14]||(e[14]=[r("Are you sure you want to delete this unit?")])),_:1,__:[14]}),t(V,null,{default:l(()=>[t(F),t(u,{onClick:e[7]||(e[7]=i=>o.deleteDialog=!1)},{default:l(()=>e[15]||(e[15]=[r("Cancel")])),_:1,__:[15]}),t(u,{color:"error",loading:o.deleting,onClick:a.deleteUnit},{default:l(()=>e[16]||(e[16]=[r("Delete")])),_:1,__:[16]},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const B=L(q,[["render",R]]);export{B as default};
