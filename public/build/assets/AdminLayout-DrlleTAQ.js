import{U as F,h as O}from"./UserProfileDialog-B-tPK9f0.js";import{_ as j,c as L,a as t,w as o,b as r,d as u,e as c,r as n,f as m,t as _,m as v,g as q,u as R,o as d}from"./app-CUIuf6Py.js";import{r as G}from"./uploads-CnEkgyD_.js";const H={components:{UserProfileDialog:F},data(){return{drawer:!0,authStore:null,currentUser:null,userRoles:[],userPermissions:[],currentDate:O().format("Do MMMM YYYY"),currentYear:new Date().getFullYear(),brandingLogo:null,siteName:null,profileDialogVisible:!1,footerPoweredByText:null,footerVersion:null,footerCopyrightText:null}},computed:{resolvedBrandingLogo(){return this.brandingLogo?this.resolveImageUrl(this.brandingLogo):null},resolvedUserAvatar(){return!this.currentUser||!this.currentUser.avatar?null:this.resolveImageUrl(this.currentUser.avatar)}},methods:{async loadUser(){var p;try{const e=localStorage.getItem("admin_token");if(!e){this.$router.push("/admin/login");return}const f=await this.$axios.get("/api/v1/auth/user",{headers:{Authorization:`Bearer ${e}`}});this.currentUser=f.data,this.userRoles=f.data.roles||[],this.authStore&&(this.authStore.user=f.data,this.authStore.token=e,this.authStore.isAuthenticated=!0,this.authStore.extractRolesAndPermissions(f.data)),this.userPermissions=[],this.userRoles&&this.userRoles.length>0&&this.userRoles.forEach(y=>{y.permissions&&y.permissions.length>0&&y.permissions.forEach(s=>{this.userPermissions.includes(s.slug)||this.userPermissions.push(s.slug)})})}catch(e){console.error("Error loading user:",e),((p=e.response)==null?void 0:p.status)===401&&(localStorage.removeItem("admin_token"),this.$router.push("/admin/login"))}},async loadSettings(){try{const p=localStorage.getItem("admin_token");if(!p)return;const e=await this.$axios.get("/api/v1/settings",{headers:{Authorization:`Bearer ${p}`}});e.data.general&&e.data.general.site_name&&e.data.general.site_name.value?this.siteName=e.data.general.site_name.value:this.siteName=null,e.data.branding&&e.data.branding.logo&&e.data.branding.logo.value?this.brandingLogo=e.data.branding.logo.value:this.brandingLogo=null,e.data.footer?(e.data.footer.powered_by_text&&e.data.footer.powered_by_text.value?this.footerPoweredByText=e.data.footer.powered_by_text.value:this.footerPoweredByText=null,e.data.footer.version&&e.data.footer.version.value?this.footerVersion=e.data.footer.version.value:this.footerVersion=null,e.data.footer.copyright_text&&e.data.footer.copyright_text.value?this.footerCopyrightText=e.data.footer.copyright_text.value:this.footerCopyrightText=null):(this.footerPoweredByText=null,this.footerVersion=null,this.footerCopyrightText=null)}catch(p){console.error("Error loading settings:",p)}},async logout(){await R().logout(),this.currentUser=null,this.userRoles=[],this.userPermissions=[],this.$router.push("/admin/login")},hasPermission(p){return this.authStore&&(this.authStore.hasRole&&this.authStore.hasRole(["administrator"])||this.authStore.hasPermission&&this.authStore.hasPermission(p))?!0:!this.currentUser||!this.userPermissions||this.userPermissions.length===0?!1:this.userRoles&&this.userRoles.length>0&&this.userRoles.some(e=>e.slug==="administrator")?!0:this.userPermissions.includes(p)},resolveImageUrl(p){return G(p)},showProfileDialog(){this.profileDialogVisible=!0}},mounted(){this.authStore=R(),localStorage.getItem("admin_token")?(this.loadUser(),this.loadSettings()):this.$router.push("/admin/login")},watch:{$route(p,e){(p.name==="AdminSettings"||e&&e.name==="AdminSettings")&&this.loadSettings()}}},J={class:"pa-2"},K={key:1,class:"d-flex align-center mr-4"},Q={class:"footer-content"},X={class:"footer-brand"},Z={class:"logo-wrapper"},$=["src"],ee={class:"brand-text"},te={class:"powered-by-info"},oe={class:"info-item mb-3"},se={class:"info-label"},re={class:"info-item mb-3"},ie={class:"info-label"},ne={class:"info-item mb-2"},ae={class:"info-label"},le={class:"info-value"},de={class:"footer-info"},ue={class:"version-badge"},me={class:"copyright-text"};function ce(p,e,f,y,s,a){const k=n("v-img"),w=n("v-avatar"),b=n("v-list-item-title"),i=n("v-list-item"),P=n("v-divider"),h=n("v-list-group"),x=n("v-list"),g=n("v-icon"),D=n("v-btn"),V=n("v-navigation-drawer"),B=n("v-app-bar-nav-icon"),S=n("v-chip"),U=n("v-spacer"),A=n("v-menu"),C=n("v-app-bar"),T=n("router-view"),z=n("v-container"),I=n("v-main"),M=n("v-card-title"),N=n("v-card-text"),Y=n("v-card"),E=n("v-footer"),W=n("UserProfileDialog");return d(),L("div",null,[t(V,{modelValue:s.drawer,"onUpdate:modelValue":e[1]||(e[1]=l=>s.drawer=l),class:"gradient_color",location:"left",permanent:"","hide-overlay":"",app:"",dark:""},{append:o(()=>[r("div",J,[t(D,{link:"",router:"",onClick:e[0]||(e[0]=l=>a.logout()),class:"logout-btn text-black",size:"small",block:""},{default:o(()=>[t(g,{left:""},{default:o(()=>e[5]||(e[5]=[m("mdi-logout")])),_:1,__:[5]}),e[6]||(e[6]=m("Logout "))]),_:1,__:[6]})])]),default:o(()=>[e[7]||(e[7]=r("div",{class:"sidebar-shapes"},[r("div",{class:"shape shape-1"}),r("div",{class:"shape shape-2"}),r("div",{class:"shape shape-3"})],-1)),s.currentUser?(d(),u(i,{key:0,class:"user-profile-header"},{prepend:o(()=>[t(w,{size:"48",class:"mr-3"},{default:o(()=>[t(k,{src:a.resolvedBrandingLogo||"/assets/logo/logo.png",alt:"Logo",cover:""},null,8,["src"])]),_:1})]),default:o(()=>[t(b,{class:"text-h6 font-weight-bold"},{default:o(()=>[m(_(s.siteName||"Admin Panel"),1)]),_:1})]),_:1})):c("",!0),t(P,{class:"my-0 divider-glow"}),s.currentUser&&s.userPermissions.length>0?(d(),u(x,{key:1,density:"compact",nav:""},{default:o(()=>[a.hasPermission("access-dashboard")?(d(),u(i,{key:0,link:"",router:"","prepend-icon":"mdi-view-dashboard",title:"Dashboard",to:{name:"AdminDashboard"},value:"Dashboard",exact:""})):c("",!0),a.hasPermission("manage-users")?(d(),u(i,{key:1,link:"",router:"","prepend-icon":"mdi-account-group",title:"Users",to:{name:"AdminUsers"},value:"Users",exact:""})):c("",!0),a.hasPermission("manage-roles")?(d(),u(h,{key:2,value:"roles","prepend-icon":"mdi-shield-account","no-action":""},{activator:o(({props:l})=>[t(i,v(l,{title:"Roles & Permissions"}),null,16)]),default:o(()=>[t(i,{"prepend-icon":"mdi-shield-account",title:"Roles",to:{name:"AdminRoles"}}),t(i,{"prepend-icon":"mdi-key",title:"Permissions",to:{name:"AdminPermissions"}})]),_:1})):c("",!0),a.hasPermission("view-products")?(d(),u(h,{key:3,value:"inventory","prepend-icon":"mdi-package-variant","no-action":""},{activator:o(({props:l})=>[t(i,v(l,{title:"Inventory"}),null,16)]),default:o(()=>[t(i,{"prepend-icon":"mdi-package",title:"Products",to:{name:"AdminProducts"}}),t(i,{"prepend-icon":"mdi-folder-multiple",title:"Categories",to:{name:"AdminCategories"}}),a.hasPermission("manage-units")?(d(),u(i,{key:0,"prepend-icon":"mdi-weight-kilogram",title:"Units",to:{name:"AdminUnits"}})):c("",!0)]),_:1})):c("",!0),a.hasPermission("view-stock-ledger")?(d(),u(h,{key:4,value:"stock","prepend-icon":"mdi-warehouse","no-action":""},{activator:o(({props:l})=>[t(i,v(l,{title:"Stock Management"}),null,16)]),default:o(()=>[t(i,{"prepend-icon":"mdi-book-open-variant",title:"Stock Ledger",to:{name:"AdminStockLedger"}}),a.hasPermission("manage-warehouses")?(d(),u(i,{key:0,"prepend-icon":"mdi-home-city",title:"Warehouses",to:{name:"AdminWarehouses"}})):c("",!0)]),_:1})):c("",!0),a.hasPermission("view-purchases")?(d(),u(h,{key:5,value:"purchase","prepend-icon":"mdi-cart-arrow-down","no-action":""},{activator:o(({props:l})=>[t(i,v(l,{title:"Purchase Management"}),null,16)]),default:o(()=>[t(i,{"prepend-icon":"mdi-receipt",title:"Supplier Invoices",to:{name:"AdminPurchases"}})]),_:1})):c("",!0),a.hasPermission("view-sales")?(d(),u(i,{key:6,link:"",router:"","prepend-icon":"mdi-point-of-sale",title:"Sales / POS",to:{name:"AdminSales"},value:"Sales",exact:""})):c("",!0),a.hasPermission("manage-suppliers")||a.hasPermission("manage-customers")?(d(),u(h,{key:7,value:"master","prepend-icon":"mdi-database","no-action":""},{activator:o(({props:l})=>[t(i,v(l,{title:"Master Data"}),null,16)]),default:o(()=>[a.hasPermission("manage-suppliers")?(d(),u(i,{key:0,"prepend-icon":"mdi-truck-delivery",title:"Suppliers",to:{name:"AdminSuppliers"}})):c("",!0),a.hasPermission("manage-customers")?(d(),u(i,{key:1,"prepend-icon":"mdi-account-group",title:"Customers",to:{name:"AdminCustomers"}})):c("",!0)]),_:1})):c("",!0),a.hasPermission("view-reports")?(d(),u(i,{key:8,link:"",router:"","prepend-icon":"mdi-chart-box",title:"Reports & Analytics",to:{name:"AdminReports"},value:"Reports",exact:""})):c("",!0),a.hasPermission("manage-settings")?(d(),u(i,{key:9,link:"",router:"","prepend-icon":"mdi-cog",title:"Settings",to:{name:"AdminSettings"},value:"Settings",exact:""})):c("",!0),a.hasPermission("view-login-logs")?(d(),u(i,{key:10,link:"",router:"","prepend-icon":"mdi-login",title:"Login Logs",to:{name:"AdminLoginLogs"},value:"Login Logs",exact:""})):c("",!0)]),_:1})):c("",!0)]),_:1,__:[7]},8,["modelValue"]),t(C,{app:"",flat:"",density:"compact",class:"gradient_color app-bar-modern"},{default:o(()=>[t(B,{onClick:e[2]||(e[2]=q(l=>s.drawer=!s.drawer,["stop"]))}),t(S,{class:"mx-2 date-chip"},{default:o(()=>[m(_(s.currentDate),1)]),_:1}),t(U),s.currentUser&&s.userRoles&&s.userRoles.some(l=>l.slug==="administrator")?(d(),u(S,{key:0,"prepend-icon":"mdi-shield-account"},{default:o(()=>e[8]||(e[8]=[m("Administrator")])),_:1,__:[8]})):c("",!0),t(U),s.currentUser?(d(),L("div",K,[t(A,{"open-on-hover":""},{activator:o(({props:l})=>[t(w,v(l,{size:"42",class:"fill-image mr-2",title:s.currentUser.name}),{default:o(()=>[s.currentUser.avatar?(d(),u(k,{key:0,cover:"",src:a.resolvedUserAvatar,alt:s.currentUser.name},null,8,["src","alt"])):(d(),u(k,{key:1,cover:"",src:"/assets/logo/logo.png",alt:"image"}))]),_:2},1040,["title"])]),default:o(()=>[t(x,null,{default:o(()=>[t(i,{onClick:a.showProfileDialog,style:{cursor:"pointer"}},{prepend:o(()=>[t(g,null,{default:o(()=>e[9]||(e[9]=[m("mdi-account")])),_:1,__:[9]})]),append:o(()=>[t(g,{size:"small"},{default:o(()=>e[10]||(e[10]=[m("mdi-chevron-right")])),_:1,__:[10]})]),default:o(()=>[t(b,null,{default:o(()=>[m(_(s.currentUser.name),1)]),_:1})]),_:1},8,["onClick"]),t(P,{class:"my-2"}),t(i,{link:"",router:"",onClick:e[3]||(e[3]=l=>a.logout())},{prepend:o(()=>[t(g,null,{default:o(()=>e[11]||(e[11]=[m("mdi-logout")])),_:1,__:[11]})]),default:o(()=>[t(b,null,{default:o(()=>e[12]||(e[12]=[m("Logout")])),_:1,__:[12]})]),_:1})]),_:1})]),_:1})])):c("",!0)]),_:1}),t(I,null,{default:o(()=>[t(z,{fluid:""},{default:o(()=>[t(T)]),_:1})]),_:1}),t(E,{class:"footer-modern gradient_color rtl-footer",app:""},{default:o(()=>[r("div",Q,[r("div",X,[r("div",Z,[r("img",{src:a.resolvedBrandingLogo||"/assets/logo/logo.png",alt:"cpb-it",height:"24",class:"footer-logo"},null,8,$)]),r("div",ee,[t(A,{"open-on-hover":"",location:"top"},{activator:o(({props:l})=>[r("span",v({class:"brand-name powered-by-text"},l),[m(_(s.footerPoweredByText||"Powered By DigiLiftPro")+" ",1),e[14]||(e[14]=r("a",{href:"https://digiliftpro.com",target:"_blank",style:{"text-decoration":"none",color:"inherit",opacity:"0.9"}},"https://digiliftpro.com",-1)),t(g,{size:"small",class:"ml-1"},{default:o(()=>e[13]||(e[13]=[m("mdi-information-outline")])),_:1,__:[13]})],16)]),default:o(()=>[t(Y,{class:"powered-by-card","min-width":"280"},{default:o(()=>[t(M,{class:"text-h6 pb-2"},{default:o(()=>[t(g,{class:"mr-2"},{default:o(()=>e[15]||(e[15]=[m("mdi-code-tags")])),_:1,__:[15]}),e[16]||(e[16]=m(" Powered By DigiLiftPro "))]),_:1,__:[16]}),t(P),t(N,{class:"pt-3"},{default:o(()=>[r("div",te,[r("div",oe,[r("div",se,[t(g,{size:"small",class:"mr-1"},{default:o(()=>e[17]||(e[17]=[m("mdi-web")])),_:1,__:[17]}),e[18]||(e[18]=m(" Website "))]),e[19]||(e[19]=r("div",{class:"info-value"},[r("a",{href:"https://digiliftpro.com",target:"_blank",style:{color:"#6366f1","text-decoration":"none"}},"https://digiliftpro.com")],-1))]),r("div",re,[r("div",ie,[t(g,{size:"small",class:"mr-1"},{default:o(()=>e[20]||(e[20]=[m("mdi-account-circle")])),_:1,__:[20]}),e[21]||(e[21]=m(" Powered By "))]),e[22]||(e[22]=r("div",{class:"info-value"},"DigiLiftPro",-1))]),r("div",ne,[r("div",ae,[t(g,{size:"small",class:"mr-1"},{default:o(()=>e[23]||(e[23]=[m("mdi-tag")])),_:1,__:[23]}),e[24]||(e[24]=m(" Version "))]),r("div",le,_(s.footerVersion||"v1.0"),1)])])]),_:1})]),_:1})]),_:1})])]),e[25]||(e[25]=r("div",{class:"footer-divider"},null,-1)),r("div",de,[r("span",ue,_(s.footerVersion||"v1.0"),1),r("span",me,"Â© "+_(s.currentYear)+" "+_(s.footerCopyrightText||"All Rights Reserved"),1)])])]),_:1}),t(W,{modelValue:s.profileDialogVisible,"onUpdate:modelValue":e[4]||(e[4]=l=>s.profileDialogVisible=l),user:s.currentUser},null,8,["modelValue","user"])])}const ve=j(H,[["render",ce],["__scopeId","data-v-f12952b6"]]);export{ve as default};
